document.addEventListener("DOMContentLoaded",function(){function s(e,t=300){const s=document.querySelector(e);if(!s)return console.warn(`Target element not found: ${e}`),!1;const o=window.pageYOffset,a=s.getBoundingClientRect().top+window.pageYOffset,r=a-120,c=r-o;let n=null;function i(e){n===null&&(n=e);const s=e-n,a=l(s,o,c,t);window.scrollTo(0,a),s<t&&requestAnimationFrame(i)}function l(e,t,n,s){return e/=s/2,e<1?n/2*e*e+t:(e--,-n/2*(e*(e-2)-1)+t)}return requestAnimationFrame(i),!0}function i(e){const t=this.getAttribute("href");if(t&&t.includes("#")){const a=t.indexOf("#"),n=t.substring(a),i=t.substring(0,a);n&&(i===""||i===window.location.pathname)?(e.preventDefault(),window.history&&window.history.pushState&&window.history.pushState(null,null,n),o(this),s(n)):n&&i!==""&&o(this)}}function o(n){t&&clearTimeout(t),t=setTimeout(()=>{t=null},0),document.querySelectorAll(".gem-sidebar a").forEach(e=>{e.classList.remove("active")}),n.classList.add("active"),e(n)}function e(e){const t=document.querySelector(".gem-sidebar");if(!t||!e)return;const n=e.offsetTop,s=e.offsetHeight,o=t.clientHeight,i=n-o/2+s/2;t.scrollTo({top:i,behavior:"smooth"})}document.querySelectorAll('a[href*="#"]').forEach(e=>{e.addEventListener("click",i)}),window.addEventListener("popstate",function(){if(window.location.hash){const o=window.location.hash.substring(1),t=document.querySelector(`.gem-sidebar a[href$="#${o}"]`);t&&(document.querySelectorAll(".gem-sidebar a").forEach(e=>{e.classList.remove("active")}),t.classList.add("active"),n=o,e(t)),s(window.location.hash)}});const a={root:null,rootMargin:"-120px 0px -60% 0px",threshold:[0,.1,.5,1]};let n=null,t=null;const r=new IntersectionObserver(s=>{if(t)return;const o=s.filter(e=>e.isIntersecting).sort((e,t)=>t.intersectionRatio-e.intersectionRatio);if(o.length>0){const s=o[0],t=s.target.getAttribute("id");if(t&&t!==n){n=t;const s=document.querySelector(`.gem-sidebar a[href$="#${t}"]`);s&&(document.querySelectorAll(".gem-sidebar a").forEach(e=>{e.classList.remove("active")}),s.classList.add("active"),e(s),window.history&&window.history.replaceState&&window.history.replaceState(null,null,`#${t}`))}}},a);document.querySelectorAll("h2[id], h3[id], section[id], .expandable-section[id]").forEach(e=>{r.observe(e)});function c(){const o=window.location.pathname,i=window.location.hash;if(i){const o=i.substring(1),t=document.querySelector(`.gem-sidebar a[href$="#${o}"]`);if(t){t.classList.add("active"),n=o,e(t),s(i);return}}let t=null;if(t=document.querySelector(`.gem-sidebar a[href="${o}"]`),!t){const e=o.replace(/\/$/,"");t=document.querySelector(`.gem-sidebar a[href="${e}"]`)}if(!t&&!o.endsWith("/")&&(t=document.querySelector(`.gem-sidebar a[href="${o}/"]`)),t)t.classList.add("active"),e(t);else{const t=document.querySelector(".gem-sidebar a");t&&(t.classList.add("active"),e(t))}}c()})